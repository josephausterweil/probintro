<!DOCTYPE html>
<html lang="en-us" dir="ltr" itemscope itemtype="http://schema.org/Article" data-r-output-format="html">
  <head><script src="/probintro/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=probintro/livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.148.2">
    <meta name="generator" content="Relearn 8.0.0+9803d5122ebb3276acea823f476e9eb44f607862">
    <meta name="description" content="From Following Recipes to Creating Your Own You‚Äôve learned to use GenJAX through examples. Now it‚Äôs time to build your own probabilistic models!
This chapter shows you how to think about building generative models ‚Äî turning real-world problems into code.
The Model-Building Process Step 1: Understand the Problem Before writing any code, answer:
What am I trying to predict or understand? (The question) What do I observe? (The data/evidence) What‚Äôs hidden? (The unknown variables) How are they related? (The causal structure) Example: Spam detection">
    <meta name="author" content="Joseph Austerweil">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Building Your Own Models :: Probability & Probabilistic Computing Tutorial">
    <meta name="twitter:description" content="From Following Recipes to Creating Your Own You‚Äôve learned to use GenJAX through examples. Now it‚Äôs time to build your own probabilistic models!
This chapter shows you how to think about building generative models ‚Äî turning real-world problems into code.
The Model-Building Process Step 1: Understand the Problem Before writing any code, answer:
What am I trying to predict or understand? (The question) What do I observe? (The data/evidence) What‚Äôs hidden? (The unknown variables) How are they related? (The causal structure) Example: Spam detection">
    <meta property="og:url" content="http://localhost:1313/probintro/genjax/06_building_models/index.html">
    <meta property="og:site_name" content="Probability & Probabilistic Computing Tutorial">
    <meta property="og:title" content="Building Your Own Models :: Probability & Probabilistic Computing Tutorial">
    <meta property="og:description" content="From Following Recipes to Creating Your Own You‚Äôve learned to use GenJAX through examples. Now it‚Äôs time to build your own probabilistic models!
This chapter shows you how to think about building generative models ‚Äî turning real-world problems into code.
The Model-Building Process Step 1: Understand the Problem Before writing any code, answer:
What am I trying to predict or understand? (The question) What do I observe? (The data/evidence) What‚Äôs hidden? (The unknown variables) How are they related? (The causal structure) Example: Spam detection">
    <meta property="og:locale" content="en_us">
    <meta property="og:type" content="article">
    <meta property="article:section" content="Probabilistic Programming with GenJAX">
    <meta itemprop="name" content="Building Your Own Models :: Probability & Probabilistic Computing Tutorial">
    <meta itemprop="description" content="From Following Recipes to Creating Your Own You‚Äôve learned to use GenJAX through examples. Now it‚Äôs time to build your own probabilistic models!
This chapter shows you how to think about building generative models ‚Äî turning real-world problems into code.
The Model-Building Process Step 1: Understand the Problem Before writing any code, answer:
What am I trying to predict or understand? (The question) What do I observe? (The data/evidence) What‚Äôs hidden? (The unknown variables) How are they related? (The causal structure) Example: Spam detection">
    <meta itemprop="wordCount" content="2807">
    <title>Building Your Own Models :: Probability &amp; Probabilistic Computing Tutorial</title>
    <link href="/probintro/images/favicon.png?1764237447" rel="icon" type="image/png">
    <link href="/probintro/css/auto-complete/auto-complete.min.css?1764237447" rel="stylesheet">
    <script src="/probintro/js/auto-complete/auto-complete.min.js?1764237447" defer></script>
    <script src="/probintro/js/search-lunr.js?1764237447" defer></script>
    <script src="/probintro/js/search.js?1764237447" defer></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.index_js_url="/probintro/searchindex.en.js?1764237447";
    </script>
    <script src="/probintro/js/lunr/lunr.min.js?1764237447" defer></script>
    <script src="/probintro/js/lunr/lunr.stemmer.support.min.js?1764237447" defer></script>
    <script src="/probintro/js/lunr/lunr.multi.min.js?1764237447" defer></script>
    <script src="/probintro/js/lunr/lunr.en.min.js?1764237447" defer></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.contentLangs=['en'];
    </script>
    <link href="/probintro/fonts/fontawesome/css/fontawesome-all.min.css?1764237447" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/probintro/fonts/fontawesome/css/fontawesome-all.min.css?1764237447" rel="stylesheet"></noscript>
    <link href="/probintro/css/perfect-scrollbar/perfect-scrollbar.min.css?1764237447" rel="stylesheet">
    <link href="/probintro/css/theme.css?1764237447" rel="stylesheet">
    <link href="/probintro/css/format-html.css?1764237447" rel="stylesheet" id="R-format-style">
    <script>
      window.relearn = window.relearn || {};
      // configuration
      window.relearn.min = ``;
      window.relearn.path='\/genjax\/06_building_models\/index.html';
      window.relearn.relBasePath='..\/..';
      window.relearn.relBaseUri='..\/..\/..';
      window.relearn.absBaseUri='http:\/\/localhost:1313\/probintro';
      window.relearn.disableAnchorCopy=false;
      window.relearn.disableAnchorScrolling=false;
      window.relearn.disableInlineCopyToClipboard=false;
      window.relearn.enableBlockCodeWrap=true;
      // legal
      window.relearn.getItem = (s,n) => {return s.getItem(n)};
      window.relearn.setItem = (s,n,v) => {return s.setItem(n,v)};
      window.relearn.removeItem = (s,n) => {return s.removeItem(n)};
      // translations
      window.T_Copy_to_clipboard = `Copy to clipboard`;
      window.T_Copied_to_clipboard = `Copied to clipboard!`;
      window.T_Copy_link_to_clipboard = `Copy link to clipboard`;
      window.T_Link_copied_to_clipboard = `Copied link to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
      // variant stuff
      window.relearn.themevariants = [ 'relearn-dark' ];
      window.relearn.customvariantname = "my-custom-variant";
      window.relearn.changeVariant = function(variant) {
        var oldVariant = document.documentElement.dataset.rThemeVariant;
        window.relearn.setItem(window.localStorage, window.relearn.absBaseUri + "/variant", variant);
        document.documentElement.dataset.rThemeVariant = variant;
        if (oldVariant != variant) {
          document.dispatchEvent( new CustomEvent('themeVariantLoaded', { detail: { variant, oldVariant } }) );
          window.relearn.markVariant();
        }
      }
      window.relearn.markVariant = function() {
        var variant = window.relearn.getItem(window.localStorage, window.relearn.absBaseUri + "/variant");
        document.querySelectorAll(".R-variantswitcher select").forEach((select) => {select.value = variant;});
      }
      window.relearn.initVariant = function() {
        var variant = window.relearn.getItem(window.localStorage, window.relearn.absBaseUri + "/variant") ?? "";
        if( variant == window.relearn.customvariantname ){
        }else if( !variant || !window.relearn.themevariants.includes(variant) ){
          variant = window.relearn.themevariants[0];
          window.relearn.setItem(window.localStorage, window.relearn.absBaseUri + "/variant", variant);
        }
        document.documentElement.dataset.rThemeVariant = variant;
      }
      window.relearn.initVariant();
      window.relearn.markVariant();
    </script>

<link rel="stylesheet" href="/probintro/css/custom.css">

  </head>
  <body class="mobile-support html" data-url="/probintro/genjax/06_building_models/index.html">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide"><button class="topbar-control" onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button>
            </div>
            <div class="topbar-button topbar-button-toc" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleTopbarFlyout(this)" type="button" title="Table of Contents (CTRL&#43;ALT&#43;t)"><i class="fa-fw fas fa-list-alt"></i></button>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
<nav class="TableOfContents">
  <ul>
    <li><a href="#from-following-recipes-to-creating-your-own">From Following Recipes to Creating Your Own</a></li>
    <li><a href="#the-model-building-process">The Model-Building Process</a>
      <ul>
        <li><a href="#step-1-understand-the-problem">Step 1: Understand the Problem</a></li>
        <li><a href="#step-2-sketch-the-generative-story">Step 2: Sketch the Generative Story</a></li>
        <li><a href="#step-3-choose-distributions">Step 3: Choose Distributions</a></li>
        <li><a href="#step-4-write-the-code">Step 4: Write the Code</a></li>
        <li><a href="#step-5-test-and-validate">Step 5: Test and Validate</a></li>
      </ul>
    </li>
    <li><a href="#common-patterns">Common Patterns</a>
      <ul>
        <li><a href="#pattern-1-independent-observations">Pattern 1: Independent Observations</a></li>
        <li><a href="#pattern-2-hierarchical-structure">Pattern 2: Hierarchical Structure</a></li>
        <li><a href="#pattern-3-conditional-dependencies">Pattern 3: Conditional Dependencies</a></li>
        <li><a href="#pattern-4-sequences-and-time-series">Pattern 4: Sequences and Time Series</a></li>
        <li><a href="#pattern-5-mixture-models">Pattern 5: Mixture Models</a></li>
      </ul>
    </li>
    <li><a href="#building-a-complete-model-medical-diagnosis">Building a Complete Model: Medical Diagnosis</a>
      <ul>
        <li><a href="#step-1-understand-the-problem-1">Step 1: Understand the Problem</a></li>
        <li><a href="#step-2-generative-story">Step 2: Generative Story</a></li>
        <li><a href="#step-3-write-the-model">Step 3: Write the Model</a></li>
        <li><a href="#step-4-run-inference">Step 4: Run Inference</a></li>
      </ul>
    </li>
    <li><a href="#best-practices">Best Practices</a>
      <ul>
        <li><a href="#-do">‚úÖ DO</a></li>
        <li><a href="#-dont">‚ùå DON&rsquo;T</a></li>
      </ul>
    </li>
    <li><a href="#exercises">Exercises</a>
      <ul>
        <li><a href="#exercise-1-email-spam-filter">Exercise 1: Email Spam Filter</a></li>
        <li><a href="#exercise-2-learning-from-multiple-observations">Exercise 2: Learning from Multiple Observations</a></li>
        <li><a href="#exercise-3-multi-symptom-diagnosis">Exercise 3: Multi-Symptom Diagnosis</a></li>
      </ul>
    </li>
    <li><a href="#what-youve-learned">What You&rsquo;ve Learned</a></li>
    <li><a href="#next-steps">Next Steps</a>
      <ul>
        <li><a href="#youre-ready-to-build">You&rsquo;re Ready to Build!</a></li>
        <li><a href="#1-explore-more-distributions">1. Explore More Distributions</a></li>
        <li><a href="#2-learn-advanced-inference">2. Learn Advanced Inference</a></li>
        <li><a href="#3-real-world-applications">3. Real-World Applications</a></li>
      </ul>
    </li>
    <li><a href="#the-journey">The Journey</a></li>
    <li><a href="#final-thoughts">Final Thoughts</a></li>
    <li><a href="#resources">Resources</a></li>
    <li><a href="#you-did-it">You Did It!</a></li>
  </ul>
</nav>
                </div>
              </div>
            </div>
          </div>
          <ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype="http://schema.org/BreadcrumbList"><li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><a itemprop="item" href="/probintro/index.html"><span itemprop="name">Probability &amp; Probabilistic Computing Tutorial</span></a><meta itemprop="position" content="1">&nbsp;>&nbsp;</li><li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><a itemprop="item" href="/probintro/genjax/index.html"><span itemprop="name">Probabilistic Programming with GenJAX</span></a><meta itemprop="position" content="2">&nbsp;>&nbsp;</li><li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><span itemprop="name">Building Your Own Models</span><meta itemprop="position" content="3"></li>
          </ol>
          <div class="topbar-area topbar-area-end" data-area="end">
            <div class="topbar-button topbar-button-prev" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="/probintro/genjax/04_conditioning/index.html" title="Conditioning and Inference (ü°ê)"><i class="fa-fw fas fa-chevron-left"></i></a>
            </div>
            <div class="topbar-button topbar-button-next" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="/probintro/intro2/index.html" title="Continuous Probability and Bayesian Learning (ü°í)"><i class="fa-fw fas fa-chevron-right"></i></a>
            </div>
            <div class="topbar-button topbar-button-more" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleTopbarFlyout(this)" type="button" title="More"><i class="fa-fw fas fa-ellipsis-v"></i></button>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
                  <div class="topbar-area topbar-area-more" data-area="more">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable genjax" tabindex="-1">
        <div class="flex-block-wrapper">
<article class="default">
  <header class="headline">
  </header>

<h1 id="building-your-own-models">Building Your Own Models</h1>

<h2 id="from-following-recipes-to-creating-your-own">From Following Recipes to Creating Your Own</h2>
<p>You&rsquo;ve learned to use GenJAX through examples. Now it&rsquo;s time to build your <strong>own</strong> probabilistic models!</p>
<p>This chapter shows you <strong>how to think</strong> about building generative models ‚Äî turning real-world problems into code.</p>
<p><a href="#R-image-f72c3448026a83b137c0c523d026fcf7" class="lightbox-link"><img alt="Chibany ready to build" class="lazy lightbox figure-image" loading="lazy" src="/probintro/images/chibanyplain.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-f72c3448026a83b137c0c523d026fcf7"><img alt="Chibany ready to build" class="lazy lightbox lightbox-image" loading="lazy" src="/probintro/images/chibanyplain.png"></a></p>
<hr>
<h2 id="the-model-building-process">The Model-Building Process</h2>
<h3 id="step-1-understand-the-problem">Step 1: Understand the Problem</h3>
<p><strong>Before writing any code, answer:</strong></p>
<ol>
<li><strong>What am I trying to predict or understand?</strong> (The question)</li>
<li><strong>What do I observe?</strong> (The data/evidence)</li>
<li><strong>What&rsquo;s hidden?</strong> (The unknown variables)</li>
<li><strong>How are they related?</strong> (The causal structure)</li>
</ol>
<p><strong>Example:</strong> Spam detection</p>
<ol>
<li><strong>Question:</strong> Is this email spam?</li>
<li><strong>Observations:</strong> Email content, sender, time</li>
<li><strong>Hidden:</strong> True spam status</li>
<li><strong>Relationship:</strong> Spam emails have certain word patterns</li>
</ol>
<hr>
<h3 id="step-2-sketch-the-generative-story">Step 2: Sketch the Generative Story</h3>
<p><strong>Write out the process that generates the data:</strong></p>
<p>&ldquo;First, nature chooses&hellip;, then based on that, it generates&hellip;, which produces&hellip;&rdquo;</p>
<p><strong>Example:</strong> Coin flips</p>
<ol>
<li>First, the coin has a (hidden) bias parameter</li>
<li>Based on that bias, each flip is heads or tails</li>
<li>We observe a sequence of flips</li>
</ol>
<p><strong>This narrative becomes your code!</strong></p>
<hr>
<h3 id="step-3-choose-distributions">Step 3: Choose Distributions</h3>
<p><strong>For each random choice, pick a distribution:</strong></p>
<table>
  <thead>
      <tr>
          <th>Type of Variable</th>
          <th>Common Distributions</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Binary (yes/no)</td>
          <td><code>bernoulli(p)</code></td>
      </tr>
      <tr>
          <td>Categorical (A/B/C)</td>
          <td><code>categorical(probs)</code></td>
      </tr>
      <tr>
          <td>Count (0, 1, 2, &hellip;)</td>
          <td><code>poisson(rate)</code></td>
      </tr>
      <tr>
          <td>Continuous</td>
          <td><code>normal(mean, std)</code>, <code>uniform(low, high)</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Start simple!</strong> Use <code>bernoulli</code> for most binary choices.</p>
<hr>
<h3 id="step-4-write-the-code">Step 4: Write the Code</h3>
<p><strong>Pattern:</strong></p>
<div class="highlight wrap-code" dir="auto"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#a6e22e">@gen</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">my_model</span>(parameters):
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Hidden variables (causes)</span>
</span></span><span style="display:flex;"><span>    hidden <span style="color:#f92672">=</span> distribution(<span style="color:#f92672">...</span>) <span style="color:#f92672">@</span> <span style="color:#e6db74">&#34;hidden&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Observed variables (effects)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Usually depend on hidden variables</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> hidden:
</span></span><span style="display:flex;"><span>        observed <span style="color:#f92672">=</span> distribution_A(<span style="color:#f92672">...</span>) <span style="color:#f92672">@</span> <span style="color:#e6db74">&#34;observed&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        observed <span style="color:#f92672">=</span> distribution_B(<span style="color:#f92672">...</span>) <span style="color:#f92672">@</span> <span style="color:#e6db74">&#34;observed&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> hidden  <span style="color:#75715e"># Or whatever you want to predict</span></span></span></code></pre></td></tr></table>
</div>
</div>
<p><strong>Key points:</strong></p>
<ul>
<li>Use <code>@gen</code> decorator</li>
<li>Name all random choices with <code>@ &quot;name&quot;</code></li>
<li>Return what you want to infer</li>
<li>Use <code>if</code> statements to model dependencies</li>
</ul>
<hr>
<h3 id="step-5-test-and-validate">Step 5: Test and Validate</h3>
<ol>
<li><strong>Generate samples</strong> ‚Äî does the output look reasonable?</li>
<li><strong>Check extreme cases</strong> ‚Äî what if parameters are 0 or 1?</li>
<li><strong>Verify inference</strong> ‚Äî do posterior results make intuitive sense?</li>
</ol>

<details open class=" box cstyle notices " style=";--VARIABLE-BOX-color: success">
  <summary class="box-label" tabindex="-1">
    üìê‚Üíüíª Math-to-Code Translation
  </summary>
  <div class="box-content">
<p><strong>How model-building concepts translate to GenJAX:</strong></p>
<table>
  <thead>
      <tr>
          <th>Math Concept</th>
          <th>Mathematical Notation</th>
          <th>GenJAX Pattern</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>Joint Distribution</strong></td>
          <td>$P(X, Y)$</td>
          <td>Multiple <code>bernoulli()</code> calls in @gen function</td>
      </tr>
      <tr>
          <td><strong>Conditional Distribution</strong></td>
          <td>$P(Y \mid X)$</td>
          <td><code>if X: Y = bernoulli(p1)</code></td>
      </tr>
      <tr>
          <td><strong>Independence</strong></td>
          <td>$P(X, Y) = P(X) \cdot P(Y)$</td>
          <td>Separate random choices (no if statements)</td>
      </tr>
      <tr>
          <td><strong>Dependence</strong></td>
          <td>$P(Y \mid X) \neq P(Y)$</td>
          <td>Y&rsquo;s distribution uses X in if statement</td>
      </tr>
      <tr>
          <td><strong>Hierarchical Model</strong></td>
          <td>$\theta \sim \text{Prior}, X \mid \theta$</td>
          <td>Parameter as random variable: <code>theta = uniform() @ &quot;theta&quot;</code></td>
      </tr>
      <tr>
          <td><strong>Mixture Model</strong></td>
          <td>$\sum_k P(Z=k) P(X \mid Z=k)$</td>
          <td><code>if category == k: X = distribution_k()</code></td>
      </tr>
      <tr>
          <td><strong>Sequence Model</strong></td>
          <td>$P(X_t \mid X_{t-1})$</td>
          <td>Loop with prev_state dependency</td>
      </tr>
  </tbody>
</table>
<p><strong>Common modeling patterns:</strong></p>
<table>
  <thead>
      <tr>
          <th>Pattern</th>
          <th>Probability Structure</th>
          <th>Code Structure</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>Independent observations</strong></td>
          <td>$P(X_1, \ldots, X_n) = \prod P(X_i)$</td>
          <td><code>for i: X_i = bernoulli()</code></td>
      </tr>
      <tr>
          <td><strong>Hierarchical</strong></td>
          <td>$P(\theta) P(X \mid \theta)$</td>
          <td><code>theta = uniform(); X = bernoulli(theta)</code></td>
      </tr>
      <tr>
          <td><strong>Conditional</strong></td>
          <td>$P(Y \mid X)$ depends on X</td>
          <td><code>if X: Y = bernoulli(p1) else: Y = bernoulli(p2)</code></td>
      </tr>
      <tr>
          <td><strong>Time series</strong></td>
          <td>$P(X_t \mid X_{t-1})$</td>
          <td><code>for t: X[t] = bernoulli(f(X[t-1]))</code></td>
      </tr>
      <tr>
          <td><strong>Mixture</strong></td>
          <td>$\sum_k \pi_k P(X \mid k)$</td>
          <td><code>k = categorical(pi); if k==0: ... else: ...</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Key insights:</strong></p>
<ul>
<li><strong>@gen function = Joint distribution</strong> ‚Äî Defines P(all variables)</li>
<li><strong>if statements = Conditional dependence</strong> ‚Äî Y depends on X</li>
<li><strong>for loops = Repeated structure</strong> ‚Äî Multiple observations or time steps</li>
<li><strong>Parameters as random variables = Hierarchical</strong> ‚Äî Uncertainty at multiple levels</li>
<li><strong>Your generative story = The math</strong> ‚Äî If you can describe how data is generated, you can code it</li>
</ul>
<p><strong>Example: Medical diagnosis</strong></p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>Math: P(Disease, Fever, Cough) = P(Disease) √ó P(Fever|Disease) √ó P(Cough|Disease)
Code: has_disease = bernoulli(0.01) @ &#34;disease&#34;
      if has_disease:
          fever = bernoulli(0.9) @ &#34;fever&#34;
          cough = bernoulli(0.8) @ &#34;cough&#34;</code></pre></div>
  </div>
</details>
<hr>
<h2 id="common-patterns">Common Patterns</h2>
<h3 id="pattern-1-independent-observations">Pattern 1: Independent Observations</h3>
<p><strong>Scenario:</strong> Multiple independent measurements</p>
<p><strong>Example:</strong> Coin flips</p>
<div class="highlight wrap-code" dir="auto"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#a6e22e">@gen</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">coin_flips</span>(n_flips, bias<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Generate n independent coin flips.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    results <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(n_flips):
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Each flip is independent</span>
</span></span><span style="display:flex;"><span>        flip <span style="color:#f92672">=</span> bernoulli(bias) <span style="color:#f92672">@</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;flip_</span><span style="color:#e6db74">{</span>i<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        results<span style="color:#f92672">.</span>append(flip)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> jnp<span style="color:#f92672">.</span>array(results)</span></span></code></pre></td></tr></table>
</div>
</div>
<p><strong>Usage:</strong></p>
<div class="highlight wrap-code" dir="auto"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>key <span style="color:#f92672">=</span> jax<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>key(<span style="color:#ae81ff">42</span>)
</span></span><span style="display:flex;"><span>trace <span style="color:#f92672">=</span> coin_flips<span style="color:#f92672">.</span>simulate(key, (<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">0.7</span>))
</span></span><span style="display:flex;"><span>flips <span style="color:#f92672">=</span> trace<span style="color:#f92672">.</span>get_retval()
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Flips: </span><span style="color:#e6db74">{</span>flips<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)</span></span></code></pre></td></tr></table>
</div>
</div>
<hr>
<h3 id="pattern-2-hierarchical-structure">Pattern 2: Hierarchical Structure</h3>
<p><strong>Scenario:</strong> Parameters have their own distributions</p>
<p><strong>Example:</strong> Learning a coin&rsquo;s bias from flips</p>
<div class="highlight wrap-code" dir="auto"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#a6e22e">@gen</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">coin_with_unknown_bias</span>(n_flips):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Coin with unknown bias ‚Äî infer it from flips.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Hidden: the coin&#39;s true bias (uniform between 0 and 1)</span>
</span></span><span style="display:flex;"><span>    bias <span style="color:#f92672">=</span> uniform(<span style="color:#ae81ff">0.0</span>, <span style="color:#ae81ff">1.0</span>) <span style="color:#f92672">@</span> <span style="color:#e6db74">&#34;bias&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Observations: flip outcomes</span>
</span></span><span style="display:flex;"><span>    flips <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(n_flips):
</span></span><span style="display:flex;"><span>        flip <span style="color:#f92672">=</span> bernoulli(bias) <span style="color:#f92672">@</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;flip_</span><span style="color:#e6db74">{</span>i<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        flips<span style="color:#f92672">.</span>append(flip)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> bias  <span style="color:#75715e"># Want to infer this!</span></span></span></code></pre></td></tr></table>
</div>
</div>
<p><strong>Inference:</strong></p>
<div class="highlight wrap-code" dir="auto"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> genjax <span style="color:#f92672">import</span> ChoiceMap
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Observe 7 heads out of 10 flips</span>
</span></span><span style="display:flex;"><span>observations <span style="color:#f92672">=</span> ChoiceMap({
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;flip_0&#34;</span>: <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#34;flip_1&#34;</span>: <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#34;flip_2&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;flip_3&#34;</span>: <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#34;flip_4&#34;</span>: <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#34;flip_5&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;flip_6&#34;</span>: <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#34;flip_7&#34;</span>: <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#34;flip_8&#34;</span>: <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;flip_9&#34;</span>: <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Infer bias</span>
</span></span><span style="display:flex;"><span>keys <span style="color:#f92672">=</span> jax<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>split(key, <span style="color:#ae81ff">1000</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">infer_bias</span>(k):
</span></span><span style="display:flex;"><span>    trace, weight <span style="color:#f92672">=</span> coin_with_unknown_bias<span style="color:#f92672">.</span>generate(k, (<span style="color:#ae81ff">10</span>,), observations)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> trace<span style="color:#f92672">.</span>get_retval()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>posterior_bias <span style="color:#f92672">=</span> jax<span style="color:#f92672">.</span>vmap(infer_bias)(keys)
</span></span><span style="display:flex;"><span>mean_bias <span style="color:#f92672">=</span> jnp<span style="color:#f92672">.</span>mean(posterior_bias)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Estimated bias: </span><span style="color:#e6db74">{</span>mean_bias<span style="color:#e6db74">:</span><span style="color:#e6db74">.2f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Should be around 0.70 (7 heads / 10 flips)</span></span></span></code></pre></td></tr></table>
</div>
</div>
<hr>
<h3 id="pattern-3-conditional-dependencies">Pattern 3: Conditional Dependencies</h3>
<p><strong>Scenario:</strong> Observations depend on hidden state</p>
<p><strong>Example:</strong> Weather affects mood</p>
<div class="highlight wrap-code" dir="auto"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#a6e22e">@gen</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">mood_model</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Weather affects Chibany&#39;s mood.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Hidden: today&#39;s weather</span>
</span></span><span style="display:flex;"><span>    is_sunny <span style="color:#f92672">=</span> bernoulli(<span style="color:#ae81ff">0.7</span>) <span style="color:#f92672">@</span> <span style="color:#e6db74">&#34;is_sunny&#34;</span>  <span style="color:#75715e"># 70% sunny days</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Observable: Chibany&#39;s mood depends on weather</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> is_sunny:
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Sunny ‚Üí happy 90% of the time</span>
</span></span><span style="display:flex;"><span>        is_happy <span style="color:#f92672">=</span> bernoulli(<span style="color:#ae81ff">0.9</span>) <span style="color:#f92672">@</span> <span style="color:#e6db74">&#34;is_happy&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Rainy ‚Üí happy only 30% of the time</span>
</span></span><span style="display:flex;"><span>        is_happy <span style="color:#f92672">=</span> bernoulli(<span style="color:#ae81ff">0.3</span>) <span style="color:#f92672">@</span> <span style="color:#e6db74">&#34;is_happy&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> is_sunny</span></span></code></pre></td></tr></table>
</div>
</div>
<p><strong>Question:</strong> &ldquo;Chibany is happy. What&rsquo;s the probability it&rsquo;s sunny?&rdquo;</p>
<div class="highlight wrap-code" dir="auto"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>observation <span style="color:#f92672">=</span> ChoiceMap({<span style="color:#e6db74">&#34;is_happy&#34;</span>: <span style="color:#ae81ff">1</span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">infer_weather</span>(k):
</span></span><span style="display:flex;"><span>    trace, weight <span style="color:#f92672">=</span> mood_model<span style="color:#f92672">.</span>generate(k, (), observation)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> trace<span style="color:#f92672">.</span>get_retval()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>keys <span style="color:#f92672">=</span> jax<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>split(key, <span style="color:#ae81ff">10000</span>)
</span></span><span style="display:flex;"><span>posterior_sunny <span style="color:#f92672">=</span> jax<span style="color:#f92672">.</span>vmap(infer_weather)(keys)
</span></span><span style="display:flex;"><span>prob_sunny <span style="color:#f92672">=</span> jnp<span style="color:#f92672">.</span>mean(posterior_sunny)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;P(Sunny | Happy) ‚âà </span><span style="color:#e6db74">{</span>prob_sunny<span style="color:#e6db74">:</span><span style="color:#e6db74">.3f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)</span></span></code></pre></td></tr></table>
</div>
</div>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Theoretical Answer
  </summary>
  <div class="box-content">
<p>Using Bayes&rsquo; theorem:</p>
<p>$$P(\text{Sunny} \mid \text{Happy}) = \frac{P(\text{Happy} \mid \text{Sunny}) \cdot P(\text{Sunny})}{P(\text{Happy})}$$</p>
<ul>
<li>$P(\text{Sunny}) = 0.7$</li>
<li>$P(\text{Happy} \mid \text{Sunny}) = 0.9$</li>
<li>$P(\text{Happy} \mid \text{Rainy}) = 0.3$</li>
<li>$P(\text{Happy}) = 0.7 \times 0.9 + 0.3 \times 0.3 = 0.63 + 0.09 = 0.72$</li>
</ul>
<p>$$P = \frac{0.9 \times 0.7}{0.72} = \frac{0.63}{0.72} \approx 0.875$$</p>
<p><strong>Expected:</strong> ‚âà 87.5%</p>
  </div>
</details>
<hr>
<h3 id="pattern-4-sequences-and-time-series">Pattern 4: Sequences and Time Series</h3>
<p><strong>Scenario:</strong> Events unfold over time</p>
<p><strong>Example:</strong> Chibany&rsquo;s weekly meals</p>
<div class="highlight wrap-code" dir="auto"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#a6e22e">@gen</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">weekly_meals</span>(days<span style="color:#f92672">=</span><span style="color:#ae81ff">7</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Model a week of meals with memory.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    meals <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># First day is random</span>
</span></span><span style="display:flex;"><span>    prev_meal <span style="color:#f92672">=</span> bernoulli(<span style="color:#ae81ff">0.5</span>) <span style="color:#f92672">@</span> <span style="color:#e6db74">&#34;day_0&#34;</span>
</span></span><span style="display:flex;"><span>    meals<span style="color:#f92672">.</span>append(prev_meal)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Each subsequent day depends on previous day</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> day <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, days):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> prev_meal <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:  <span style="color:#75715e"># Had tonkatsu yesterday</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Want variety ‚Üí lower probability</span>
</span></span><span style="display:flex;"><span>            current_meal <span style="color:#f92672">=</span> bernoulli(<span style="color:#ae81ff">0.3</span>) <span style="color:#f92672">@</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;day_</span><span style="color:#e6db74">{</span>day<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:  <span style="color:#75715e"># Had hamburger yesterday</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Craving tonkatsu ‚Üí higher probability</span>
</span></span><span style="display:flex;"><span>            current_meal <span style="color:#f92672">=</span> bernoulli(<span style="color:#ae81ff">0.8</span>) <span style="color:#f92672">@</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;day_</span><span style="color:#e6db74">{</span>day<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        meals<span style="color:#f92672">.</span>append(current_meal)
</span></span><span style="display:flex;"><span>        prev_meal <span style="color:#f92672">=</span> current_meal
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> jnp<span style="color:#f92672">.</span>array(meals)</span></span></code></pre></td></tr></table>
</div>
</div>
<p><strong>This models dependence through time!</strong></p>
<hr>
<h3 id="pattern-5-mixture-models">Pattern 5: Mixture Models</h3>
<p><strong>Scenario:</strong> Data comes from multiple sources</p>
<p><strong>Example:</strong> Two types of days (weekday vs weekend)</p>
<div class="highlight wrap-code" dir="auto"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#a6e22e">@gen</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">mixed_days</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Different behavior on weekends vs weekdays.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Hidden: is it a weekend?</span>
</span></span><span style="display:flex;"><span>    is_weekend <span style="color:#f92672">=</span> bernoulli(<span style="color:#ae81ff">2</span><span style="color:#f92672">/</span><span style="color:#ae81ff">7</span>) <span style="color:#f92672">@</span> <span style="color:#e6db74">&#34;is_weekend&#34;</span>  <span style="color:#75715e"># 2 out of 7 days</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> is_weekend:
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Weekend: high chance of tonkatsu (relaxed)</span>
</span></span><span style="display:flex;"><span>        tonkatsu_prob <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.9</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Weekday: lower chance (busy)</span>
</span></span><span style="display:flex;"><span>        tonkatsu_prob <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.3</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    lunch <span style="color:#f92672">=</span> bernoulli(tonkatsu_prob) <span style="color:#f92672">@</span> <span style="color:#e6db74">&#34;lunch&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> is_weekend</span></span></code></pre></td></tr></table>
</div>
</div>
<p><strong>Infer:</strong> &ldquo;Given Chibany had tonkatsu, is it a weekend?&rdquo;</p>
<hr>
<h2 id="building-a-complete-model-medical-diagnosis">Building a Complete Model: Medical Diagnosis</h2>
<p>Let&rsquo;s build a realistic example from scratch.</p>
<p><strong>Scenario:</strong> Diagnosing a disease based on symptoms</p>
<p><strong>Setup:</strong></p>
<ul>
<li>Disease prevalence: 1% (rare)</li>
<li>Symptom 1 (fever): 90% if diseased, 10% if healthy</li>
<li>Symptom 2 (cough): 80% if diseased, 20% if healthy</li>
</ul>
<p><strong>Question:</strong> Patient has fever and cough. Probability of disease?</p>
<h3 id="step-1-understand-the-problem-1">Step 1: Understand the Problem</h3>
<ul>
<li><strong>Question:</strong> Does patient have disease?</li>
<li><strong>Observations:</strong> Fever and cough</li>
<li><strong>Hidden:</strong> True disease status</li>
<li><strong>Relationships:</strong> Symptoms more likely if diseased</li>
</ul>
<h3 id="step-2-generative-story">Step 2: Generative Story</h3>
<ol>
<li>First, patient either has disease (1%) or not (99%)</li>
<li>If diseased, fever is very likely (90%)</li>
<li>If diseased, cough is very likely (80%)</li>
<li>If healthy, both symptoms are rare (10%, 20%)</li>
</ol>
<h3 id="step-3-write-the-model">Step 3: Write the Model</h3>
<div class="highlight wrap-code" dir="auto"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#a6e22e">@gen</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">disease_model</span>(prevalence<span style="color:#f92672">=</span><span style="color:#ae81ff">0.01</span>, fever_if_disease<span style="color:#f92672">=</span><span style="color:#ae81ff">0.9</span>, cough_if_disease<span style="color:#f92672">=</span><span style="color:#ae81ff">0.8</span>,
</span></span><span style="display:flex;"><span>                  fever_if_healthy<span style="color:#f92672">=</span><span style="color:#ae81ff">0.1</span>, cough_if_healthy<span style="color:#f92672">=</span><span style="color:#ae81ff">0.2</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Medical diagnosis model.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Hidden: disease status</span>
</span></span><span style="display:flex;"><span>    has_disease <span style="color:#f92672">=</span> bernoulli(prevalence) <span style="color:#f92672">@</span> <span style="color:#e6db74">&#34;has_disease&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Symptoms depend on disease</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> has_disease:
</span></span><span style="display:flex;"><span>        fever <span style="color:#f92672">=</span> bernoulli(fever_if_disease) <span style="color:#f92672">@</span> <span style="color:#e6db74">&#34;fever&#34;</span>
</span></span><span style="display:flex;"><span>        cough <span style="color:#f92672">=</span> bernoulli(cough_if_disease) <span style="color:#f92672">@</span> <span style="color:#e6db74">&#34;cough&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        fever <span style="color:#f92672">=</span> bernoulli(fever_if_healthy) <span style="color:#f92672">@</span> <span style="color:#e6db74">&#34;fever&#34;</span>
</span></span><span style="display:flex;"><span>        cough <span style="color:#f92672">=</span> bernoulli(cough_if_healthy) <span style="color:#f92672">@</span> <span style="color:#e6db74">&#34;cough&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> has_disease</span></span></code></pre></td></tr></table>
</div>
</div>
<h3 id="step-4-run-inference">Step 4: Run Inference</h3>
<div class="highlight wrap-code" dir="auto"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Patient has both symptoms</span>
</span></span><span style="display:flex;"><span>observation <span style="color:#f92672">=</span> ChoiceMap({<span style="color:#e6db74">&#34;fever&#34;</span>: <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#34;cough&#34;</span>: <span style="color:#ae81ff">1</span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">infer_disease</span>(k):
</span></span><span style="display:flex;"><span>    trace, weight <span style="color:#f92672">=</span> disease_model<span style="color:#f92672">.</span>generate(k, (), observation)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> trace<span style="color:#f92672">.</span>get_retval()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>keys <span style="color:#f92672">=</span> jax<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>split(key, <span style="color:#ae81ff">10000</span>)
</span></span><span style="display:flex;"><span>posterior <span style="color:#f92672">=</span> jax<span style="color:#f92672">.</span>vmap(infer_disease)(keys)
</span></span><span style="display:flex;"><span>prob_disease <span style="color:#f92672">=</span> jnp<span style="color:#f92672">.</span>mean(posterior)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;=== MEDICAL DIAGNOSIS ===&#34;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Prevalence: 1%&#34;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Symptoms: Fever + Cough&#34;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;P(Disease | Symptoms) ‚âà </span><span style="color:#e6db74">{</span>prob_disease<span style="color:#e6db74">:</span><span style="color:#e6db74">.3f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)</span></span></code></pre></td></tr></table>
</div>
</div>
<p><strong>Expected output:</strong> ‚âà 0.265 (26.5%)</p>
<p><strong>Interpretation:</strong> Even with both symptoms, only 26.5% chance of disease because it&rsquo;s so rare!</p>

<details open class=" box cstyle notices warning">
  <summary class="box-label" tabindex="-1">
    <i class="fa-fw fas fa-exclamation-triangle"></i> 
    Base Rate Neglect in Medicine!
  </summary>
  <div class="box-content">
<p><strong>This is why false positives are a problem in medical testing.</strong></p>
<p>Even accurate tests produce many false positives for rare diseases because:</p>
<ul>
<li>True positives: $0.01 \times 0.9 \times 0.8 = 0.0072$ (0.72%)</li>
<li>False positives: $0.99 \times 0.1 \times 0.2 = 0.0198$ (1.98%)</li>
</ul>
<p><strong>More false positives than true positives!</strong></p>
<p>This is why doctors don&rsquo;t diagnose based on symptoms alone ‚Äî they need confirmatory tests or consider patient history (updating the prior).</p>
  </div>
</details>
<hr>
<h2 id="best-practices">Best Practices</h2>
<h3 id="-do">‚úÖ DO</h3>
<ol>
<li>
<p><strong>Name everything clearly</strong></p>
<div class="highlight wrap-code" dir="auto"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Good</span>
</span></span><span style="display:flex;"><span>is_diseased <span style="color:#f92672">=</span> bernoulli(<span style="color:#ae81ff">0.01</span>) <span style="color:#f92672">@</span> <span style="color:#e6db74">&#34;is_diseased&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Bad</span>
</span></span><span style="display:flex;"><span>x <span style="color:#f92672">=</span> bernoulli(<span style="color:#ae81ff">0.01</span>) <span style="color:#f92672">@</span> <span style="color:#e6db74">&#34;x&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div>
</li>
<li>
<p><strong>Use meaningful parameters</strong></p>
<div class="highlight wrap-code" dir="auto"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Good</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@gen</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">model</span>(disease_prevalence<span style="color:#f92672">=</span><span style="color:#ae81ff">0.01</span>, test_accuracy<span style="color:#f92672">=</span><span style="color:#ae81ff">0.95</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Bad</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@gen</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">model</span>(p1<span style="color:#f92672">=</span><span style="color:#ae81ff">0.01</span>, p2<span style="color:#f92672">=</span><span style="color:#ae81ff">0.95</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">...</span></span></span></code></pre></td></tr></table>
</div>
</div>
</li>
<li>
<p><strong>Document your model</strong></p>
<div class="highlight wrap-code" dir="auto"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#a6e22e">@gen</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">weather_mood</span>(sunny_prior<span style="color:#f92672">=</span><span style="color:#ae81ff">0.7</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Model how weather affects mood.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    Args:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        sunny_prior: Base rate of sunny days (default 0.7)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    Returns:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        is_sunny: Whether it&#39;s sunny today
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div>
</li>
<li>
<p><strong>Start simple, add complexity</strong></p>
<ul>
<li>Build the simplest model first</li>
<li>Verify it works</li>
<li>Add features incrementally</li>
</ul>
</li>
<li>
<p><strong>Test edge cases</strong></p>
<ul>
<li>What if parameters are 0? 1?</li>
<li>What if all observations are the same?</li>
<li>Does the posterior make intuitive sense?</li>
</ul>
</li>
</ol>
<hr>
<h3 id="-dont">‚ùå DON&rsquo;T</h3>
<ol>
<li>
<p><strong>Don&rsquo;t forget to name random choices</strong></p>
<div class="highlight wrap-code" dir="auto"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Bad ‚Äî can&#39;t condition on this!</span>
</span></span><span style="display:flex;"><span>x <span style="color:#f92672">=</span> bernoulli(<span style="color:#ae81ff">0.5</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Good</span>
</span></span><span style="display:flex;"><span>x <span style="color:#f92672">=</span> bernoulli(<span style="color:#ae81ff">0.5</span>) <span style="color:#f92672">@</span> <span style="color:#e6db74">&#34;x&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div>
</li>
<li>
<p><strong>Don&rsquo;t use the same name twice</strong></p>
<div class="highlight wrap-code" dir="auto"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Bad ‚Äî name collision!</span>
</span></span><span style="display:flex;"><span>flip1 <span style="color:#f92672">=</span> bernoulli(<span style="color:#ae81ff">0.5</span>) <span style="color:#f92672">@</span> <span style="color:#e6db74">&#34;flip&#34;</span>
</span></span><span style="display:flex;"><span>flip2 <span style="color:#f92672">=</span> bernoulli(<span style="color:#ae81ff">0.5</span>) <span style="color:#f92672">@</span> <span style="color:#e6db74">&#34;flip&#34;</span>  <span style="color:#75715e"># ERROR!</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Good ‚Äî unique names</span>
</span></span><span style="display:flex;"><span>flip1 <span style="color:#f92672">=</span> bernoulli(<span style="color:#ae81ff">0.5</span>) <span style="color:#f92672">@</span> <span style="color:#e6db74">&#34;flip_1&#34;</span>
</span></span><span style="display:flex;"><span>flip2 <span style="color:#f92672">=</span> bernoulli(<span style="color:#ae81ff">0.5</span>) <span style="color:#f92672">@</span> <span style="color:#e6db74">&#34;flip_2&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div>
</li>
<li>
<p><strong>Don&rsquo;t overthink distributions</strong></p>
<ul>
<li><code>bernoulli</code> covers most binary cases</li>
<li><code>normal</code> for continuous</li>
<li><code>categorical</code> for multiple choices</li>
<li>You don&rsquo;t need exotic distributions to start!</li>
</ul>
</li>
<li>
<p><strong>Don&rsquo;t skip validation</strong></p>
<ul>
<li>Always generate samples first</li>
<li>Check if outputs look reasonable</li>
<li>Verify extreme parameter values</li>
</ul>
</li>
</ol>
<hr>
<h2 id="exercises">Exercises</h2>
<h3 id="exercise-1-email-spam-filter">Exercise 1: Email Spam Filter</h3>
<p>Build a simple spam filter model.</p>
<p><strong>Scenario:</strong></p>
<ul>
<li>30% of emails are spam</li>
<li>Spam emails contain &ldquo;FREE&rdquo; 80% of the time</li>
<li>Legitimate emails contain &ldquo;FREE&rdquo; 10% of the time</li>
</ul>
<p><strong>Task:</strong> Calculate $P(\text{Spam} \mid \text{contains &ldquo;FREE&rdquo;})$</p>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#a6e22e">@gen</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">spam_filter</span>(spam_rate<span style="color:#f92672">=</span><span style="color:#ae81ff">0.30</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Simple spam filter based on keyword.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Hidden: is it spam?</span>
</span></span><span style="display:flex;"><span>    is_spam <span style="color:#f92672">=</span> bernoulli(spam_rate) <span style="color:#f92672">@</span> <span style="color:#e6db74">&#34;is_spam&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Observation: contains &#34;FREE&#34;?</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> is_spam:
</span></span><span style="display:flex;"><span>        contains_free <span style="color:#f92672">=</span> bernoulli(<span style="color:#ae81ff">0.80</span>) <span style="color:#f92672">@</span> <span style="color:#e6db74">&#34;contains_free&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        contains_free <span style="color:#f92672">=</span> bernoulli(<span style="color:#ae81ff">0.10</span>) <span style="color:#f92672">@</span> <span style="color:#e6db74">&#34;contains_free&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> is_spam
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Email contains &#34;FREE&#34;</span>
</span></span><span style="display:flex;"><span>observation <span style="color:#f92672">=</span> ChoiceMap({<span style="color:#e6db74">&#34;contains_free&#34;</span>: <span style="color:#ae81ff">1</span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">infer_spam</span>(k):
</span></span><span style="display:flex;"><span>    trace, weight <span style="color:#f92672">=</span> spam_filter<span style="color:#f92672">.</span>generate(k, (), observation)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> trace<span style="color:#f92672">.</span>get_retval()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>keys <span style="color:#f92672">=</span> jax<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>split(key, <span style="color:#ae81ff">10000</span>)
</span></span><span style="display:flex;"><span>posterior <span style="color:#f92672">=</span> jax<span style="color:#f92672">.</span>vmap(infer_spam)(keys)
</span></span><span style="display:flex;"><span>prob_spam <span style="color:#f92672">=</span> jnp<span style="color:#f92672">.</span>mean(posterior)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;P(Spam | contains &#39;FREE&#39;) ‚âà </span><span style="color:#e6db74">{</span>prob_spam<span style="color:#e6db74">:</span><span style="color:#e6db74">.3f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)</span></span></code></pre></td></tr></table>
</div>
</div>
<p><strong>Expected:</strong> ‚âà 0.774 (77.4%)</p>
<p><strong>Theoretical:</strong>
$$P = \frac{0.80 \times 0.30}{0.80 \times 0.30 + 0.10 \times 0.70} = \frac{0.24}{0.31} \approx 0.774$$</p>
  </div>
</details>
<hr>
<h3 id="exercise-2-learning-from-multiple-observations">Exercise 2: Learning from Multiple Observations</h3>
<p>Extend the coin flip model to infer bias from multiple observations.</p>
<p><strong>Task:</strong> Given a sequence of 20 flips (e.g., <code>[1,1,0,1,1,1,0,1,1,1,1,0,1,1,0,1,1,1,1,1]</code>), infer the coin&rsquo;s bias.</p>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#a6e22e">@gen</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">coin_model</span>(n_flips):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Infer coin bias from observed flips.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Hidden: coin&#39;s true bias</span>
</span></span><span style="display:flex;"><span>    bias <span style="color:#f92672">=</span> uniform(<span style="color:#ae81ff">0.0</span>, <span style="color:#ae81ff">1.0</span>) <span style="color:#f92672">@</span> <span style="color:#e6db74">&#34;bias&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Observations: flips</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(n_flips):
</span></span><span style="display:flex;"><span>        flip <span style="color:#f92672">=</span> bernoulli(bias) <span style="color:#f92672">@</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;flip_</span><span style="color:#e6db74">{</span>i<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> bias
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Observed flips: 16 heads out of 20</span>
</span></span><span style="display:flex;"><span>observed_flips <span style="color:#f92672">=</span> [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>observations <span style="color:#f92672">=</span> ChoiceMap({<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;flip_</span><span style="color:#e6db74">{</span>i<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>: observed_flips[i] <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">20</span>)})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">infer_bias</span>(k):
</span></span><span style="display:flex;"><span>    trace, weight <span style="color:#f92672">=</span> coin_model<span style="color:#f92672">.</span>generate(k, (<span style="color:#ae81ff">20</span>,), observations)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> trace<span style="color:#f92672">.</span>get_retval()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>keys <span style="color:#f92672">=</span> jax<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>split(key, <span style="color:#ae81ff">1000</span>)
</span></span><span style="display:flex;"><span>posterior_bias <span style="color:#f92672">=</span> jax<span style="color:#f92672">.</span>vmap(infer_bias)(keys)
</span></span><span style="display:flex;"><span>mean_bias <span style="color:#f92672">=</span> jnp<span style="color:#f92672">.</span>mean(posterior_bias)
</span></span><span style="display:flex;"><span>std_bias <span style="color:#f92672">=</span> jnp<span style="color:#f92672">.</span>std(posterior_bias)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Estimated bias: </span><span style="color:#e6db74">{</span>mean_bias<span style="color:#e6db74">:</span><span style="color:#e6db74">.2f</span><span style="color:#e6db74">}</span><span style="color:#e6db74"> ¬± </span><span style="color:#e6db74">{</span>std_bias<span style="color:#e6db74">:</span><span style="color:#e6db74">.2f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Should be around 0.80 (16/20)</span></span></span></code></pre></td></tr></table>
</div>
</div>
<p><strong>Expected:</strong> Mean ‚âà 0.80, with some uncertainty</p>
<p><strong>Plot the posterior:</strong></p>
<div class="highlight wrap-code" dir="auto"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>hist(posterior_bias, bins<span style="color:#f92672">=</span><span style="color:#ae81ff">50</span>, density<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.7</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;#4ecdc4&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>axvline(mean_bias, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;red&#39;</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;--&#39;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;Mean = </span><span style="color:#e6db74">{</span>mean_bias<span style="color:#e6db74">:</span><span style="color:#e6db74">.2f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Coin Bias&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;Posterior Density&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Posterior Distribution of Coin Bias</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">(16 heads in 20 flips)&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>legend()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()</span></span></code></pre></td></tr></table>
</div>
</div>
  </div>
</details>
<hr>
<h3 id="exercise-3-multi-symptom-diagnosis">Exercise 3: Multi-Symptom Diagnosis</h3>
<p>Extend the disease model to include 3 symptoms: fever, cough, fatigue.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li>Disease: 2% prevalence</li>
<li>If diseased: fever 90%, cough 80%, fatigue 95%</li>
<li>If healthy: fever 10%, cough 20%, fatigue 30%</li>
</ul>
<p><strong>Task:</strong> Calculate posterior for:</p>
<ol>
<li>Fever only</li>
<li>Fever + cough</li>
<li>All three symptoms</li>
</ol>

<details class=" box cstyle notices transparent expand">
  <summary class="box-label">
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> 
    Solution
  </summary>
  <div class="box-content">
<div class="highlight wrap-code" dir="auto"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#a6e22e">@gen</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">disease_three_symptoms</span>(prevalence<span style="color:#f92672">=</span><span style="color:#ae81ff">0.02</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Disease model with three symptoms.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    has_disease <span style="color:#f92672">=</span> bernoulli(prevalence) <span style="color:#f92672">@</span> <span style="color:#e6db74">&#34;has_disease&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> has_disease:
</span></span><span style="display:flex;"><span>        fever <span style="color:#f92672">=</span> bernoulli(<span style="color:#ae81ff">0.90</span>) <span style="color:#f92672">@</span> <span style="color:#e6db74">&#34;fever&#34;</span>
</span></span><span style="display:flex;"><span>        cough <span style="color:#f92672">=</span> bernoulli(<span style="color:#ae81ff">0.80</span>) <span style="color:#f92672">@</span> <span style="color:#e6db74">&#34;cough&#34;</span>
</span></span><span style="display:flex;"><span>        fatigue <span style="color:#f92672">=</span> bernoulli(<span style="color:#ae81ff">0.95</span>) <span style="color:#f92672">@</span> <span style="color:#e6db74">&#34;fatigue&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        fever <span style="color:#f92672">=</span> bernoulli(<span style="color:#ae81ff">0.10</span>) <span style="color:#f92672">@</span> <span style="color:#e6db74">&#34;fever&#34;</span>
</span></span><span style="display:flex;"><span>        cough <span style="color:#f92672">=</span> bernoulli(<span style="color:#ae81ff">0.20</span>) <span style="color:#f92672">@</span> <span style="color:#e6db74">&#34;cough&#34;</span>
</span></span><span style="display:flex;"><span>        fatigue <span style="color:#f92672">=</span> bernoulli(<span style="color:#ae81ff">0.30</span>) <span style="color:#f92672">@</span> <span style="color:#e6db74">&#34;fatigue&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> has_disease
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Scenario 1: Fever only</span>
</span></span><span style="display:flex;"><span>obs1 <span style="color:#f92672">=</span> ChoiceMap({<span style="color:#e6db74">&#34;fever&#34;</span>: <span style="color:#ae81ff">1</span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Scenario 2: Fever + cough</span>
</span></span><span style="display:flex;"><span>obs2 <span style="color:#f92672">=</span> ChoiceMap({<span style="color:#e6db74">&#34;fever&#34;</span>: <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#34;cough&#34;</span>: <span style="color:#ae81ff">1</span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Scenario 3: All three</span>
</span></span><span style="display:flex;"><span>obs3 <span style="color:#f92672">=</span> ChoiceMap({<span style="color:#e6db74">&#34;fever&#34;</span>: <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#34;cough&#34;</span>: <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#34;fatigue&#34;</span>: <span style="color:#ae81ff">1</span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i, obs <span style="color:#f92672">in</span> enumerate([obs1, obs2, obs3], <span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">infer</span>(k):
</span></span><span style="display:flex;"><span>        trace, weight <span style="color:#f92672">=</span> disease_three_symptoms<span style="color:#f92672">.</span>generate(k, (), obs)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> trace<span style="color:#f92672">.</span>get_retval()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    keys <span style="color:#f92672">=</span> jax<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>split(key, <span style="color:#ae81ff">10000</span>)
</span></span><span style="display:flex;"><span>    posterior <span style="color:#f92672">=</span> jax<span style="color:#f92672">.</span>vmap(infer)(keys)
</span></span><span style="display:flex;"><span>    prob <span style="color:#f92672">=</span> jnp<span style="color:#f92672">.</span>mean(posterior)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Scenario </span><span style="color:#e6db74">{</span>i<span style="color:#e6db74">}</span><span style="color:#e6db74">: P(Disease) ‚âà </span><span style="color:#e6db74">{</span>prob<span style="color:#e6db74">:</span><span style="color:#e6db74">.3f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)</span></span></code></pre></td></tr></table>
</div>
</div>
<p><strong>Expected output:</strong></p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>Scenario 1: P(Disease) ‚âà 0.155  # Fever only
Scenario 2: P(Disease) ‚âà 0.419  # Fever + cough
Scenario 3: P(Disease) ‚âà 0.774  # All three symptoms</code></pre></div>
<p><strong>Insight:</strong> More evidence ‚Üí higher posterior!</p>
  </div>
</details>
<hr>
<h2 id="what-youve-learned">What You&rsquo;ve Learned</h2>
<p>In this chapter, you learned:</p>
<p>‚úÖ <strong>The model-building process</strong> ‚Äî from problem to code
‚úÖ <strong>Common patterns</strong> ‚Äî independent, hierarchical, conditional, sequential, mixture
‚úÖ <strong>Best practices</strong> ‚Äî naming, documentation, testing
‚úÖ <strong>Complete examples</strong> ‚Äî medical diagnosis, spam filtering, coin flipping
‚úÖ <strong>How to think generatively</strong> ‚Äî &ldquo;what generates the data?&rdquo;</p>
<p><strong>The key insight:</strong> Building models is about <strong>encoding your assumptions</strong> about how the world works, then letting GenJAX do the inference!</p>
<hr>
<h2 id="next-steps">Next Steps</h2>
<h3 id="youre-ready-to-build">You&rsquo;re Ready to Build!</h3>
<p>You now have all the tools to:</p>
<ul>
<li>Build generative models for your problems</li>
<li>Perform Bayesian inference automatically</li>
<li>Understand uncertainty in your predictions</li>
</ul>
<p><strong>Where to go from here:</strong></p>
<h3 id="1-explore-more-distributions">1. Explore More Distributions</h3>
<p>GenJAX supports many distributions beyond <code>bernoulli</code>:</p>
<ul>
<li><code>normal(mean, std)</code> ‚Äî Continuous values (heights, weights, temperatures)</li>
<li><code>categorical(probs)</code> ‚Äî Multiple discrete choices (A, B, C, D)</li>
<li><code>poisson(rate)</code> ‚Äî Count data (number of events)</li>
<li><code>gamma</code>, <code>beta</code>, <code>exponential</code> ‚Äî Specialized continuous distributions</li>
</ul>
<p><strong>See the GenJAX documentation</strong> for complete reference.</p>
<h3 id="2-learn-advanced-inference">2. Learn Advanced Inference</h3>
<p>This tutorial covered:</p>
<ul>
<li>Filtering/rejection sampling</li>
<li>Conditioning with <code>generate()</code></li>
</ul>
<p><strong>Next level:</strong></p>
<ul>
<li>Importance sampling (more efficient for rare events)</li>
<li>Markov Chain Monte Carlo (MCMC) for complex models</li>
<li>Variational inference (approximate but fast)</li>
</ul>
<p><strong>Check out:</strong> GenJAX advanced tutorials</p>
<h3 id="3-real-world-applications">3. Real-World Applications</h3>
<p>Apply what you learned to:</p>
<ul>
<li><strong>Science:</strong> Modeling experiments, analyzing data</li>
<li><strong>Medicine:</strong> Diagnosis, treatment optimization</li>
<li><strong>Engineering:</strong> Fault detection, quality control</li>
<li><strong>Social science:</strong> Understanding human behavior</li>
<li><strong>AI/ML:</strong> Building better models with uncertainty</li>
</ul>
<hr>
<h2 id="the-journey">The Journey</h2>
<p><strong>You started with:</strong> Sets, counting, basic probability</p>
<p><strong>Now you can:</strong> Build probabilistic programs, perform Bayesian inference, reason under uncertainty</p>
<p><strong>That&rsquo;s a huge accomplishment!</strong></p>
<hr>
<h2 id="final-thoughts">Final Thoughts</h2>
<p>Probabilistic programming is a <strong>superpower</strong>:</p>
<ol>
<li><strong>Express uncertainty</strong> ‚Äî the world is uncertain, our models should reflect that</li>
<li><strong>Automate inference</strong> ‚Äî computers do the hard math</li>
<li><strong>Combine knowledge and data</strong> ‚Äî use both domain expertise (priors) and observations (data)</li>
<li><strong>Make better decisions</strong> ‚Äî understand risks and probabilities</li>
</ol>
<p><strong>Keep building, keep learning, keep questioning!</strong></p>
<hr>
<h2 id="resources">Resources</h2>
<p><strong>GenJAX Documentation:</strong></p>
<ul>
<li>Official docs: <a href="https://gen.dev" rel="external" target="_blank">gen.dev</a></li>
<li>More examples: <a href="https://github.com/probcomp/genjax" rel="external" target="_blank">GenJAX GitHub</a></li>
</ul>
<p><strong>Probability Theory:</strong></p>
<ul>
<li>This tutorial&rsquo;s probability chapters!</li>
<li>&ldquo;Probabilistic Programming &amp; Bayesian Methods for Hackers&rdquo; (free online)</li>
<li>&ldquo;Think Bayes&rdquo; by Allen Downey (beginner-friendly)</li>
</ul>
<p><strong>Community:</strong></p>
<ul>
<li>GenJAX Discourse: Ask questions, share models</li>
<li>Probabilistic Programming Slack: Connect with practitioners</li>
</ul>
<hr>
<h2 id="you-did-it">You Did It!</h2>
<p><strong>Congratulations on completing the GenJAX tutorial!</strong></p>
<p>You&rsquo;ve gone from &ldquo;what is GenJAX?&rdquo; to building complete probabilistic models. That&rsquo;s no small feat!</p>
<p><strong>Now go build something amazing.</strong> üöÄ</p>
<hr>
<table>
  <thead>
      <tr>
          <th style="text-align: left"><a href="./05_inference.md">‚Üê Previous: Inference in Action</a></th>
          <th style="text-align: right"><a href="/probintro/genjax/index.html">Back to Introduction ‚Üí</a></th>
      </tr>
  </thead>
  <tbody>
  </tbody>
</table>

  <footer class="footline">
  </footer>
</article>
        </div>
      </main>
    </div>
    <aside id="R-sidebar" class="default-animation">
      <div id="R-header-topbar" class="default-animation"></div>
      <div id="R-header-wrapper" class="default-animation">
        <div id="R-header" class="default-animation">
          <a id="R-logo" class="R-default" href="/probintro/index.html">
            <div class="logo-title">Probability &amp; Probabilistic Computing Tutorial</div>
          </a>
        </div>
        <search><form action="/probintro/search/index.html" method="get">
          <div class="searchbox default-animation">
            <button class="search-detail" type="submit" title="Search (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
            <label class="a11y-only" for="R-search-by">Search</label>
            <input data-search-input id="R-search-by" name="search-by" class="search-by" type="search" placeholder="Search...">
            <button class="search-clear" type="button" data-search-clear="" title="Clear search"><i class="fas fa-times" title="Clear search"></i></button>
          </div>
        </form></search>
      </div>
      <div id="R-homelinks" class="default-animation homelinks">
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-homelinks">
          <ul class="space collapsible-menu">
            <li class="" data-nav-id="/probintro/index.html"><a class="padding" href="/probintro/index.html"><i class="fa-fw fas fa-home"></i> Home</a></li>
          </ul>
        </div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-headercontrols">
          <ul class="">
          </ul>
        </div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
      </div>
      <div id="R-content-wrapper" class="highlightable">
        <div class="R-sidebarmenu R-shortcutmenu-main">
          <ul class="enlarge morespace collapsible-menu">
            <li class="alwaysopen " data-nav-id="/probintro/intro/index.html"><a class="padding" href="/probintro/intro/index.html">A Narrative Introduction to Probability</a><ul id="R-subsections-58f2a84c91d5deefe8bdd3a21213404a" class="collapsible-menu"></ul></li>
            <li class="parent alwaysopen " data-nav-id="/probintro/genjax/index.html"><a class="padding" href="/probintro/genjax/index.html">Probabilistic Programming with GenJAX</a><ul id="R-subsections-40a5f3b764be01351a755ea2f58fc4ae" class="collapsible-menu">
            <li class="" data-nav-id="/probintro/genjax/00_getting_started/index.html"><a class="padding" href="/probintro/genjax/00_getting_started/index.html">Getting Started with Google Colab</a></li>
            <li class="" data-nav-id="/probintro/genjax/01_python_basics/index.html"><a class="padding" href="/probintro/genjax/01_python_basics/index.html">Python Essentials for GenJAX</a></li>
            <li class="" data-nav-id="/probintro/genjax/02_first_model/index.html"><a class="padding" href="/probintro/genjax/02_first_model/index.html">Your First GenJAX Model</a></li>
            <li class="" data-nav-id="/probintro/genjax/03_traces/index.html"><a class="padding" href="/probintro/genjax/03_traces/index.html">Understanding Traces</a></li>
            <li class="" data-nav-id="/probintro/genjax/04_conditioning/index.html"><a class="padding" href="/probintro/genjax/04_conditioning/index.html">Conditioning and Inference</a></li>
            <li class="active " data-nav-id="/probintro/genjax/06_building_models/index.html"><a class="padding" href="/probintro/genjax/06_building_models/index.html">Building Your Own Models</a></li></ul></li>
            <li class="alwaysopen " data-nav-id="/probintro/intro2/index.html"><a class="padding" href="/probintro/intro2/index.html">Continuous Probability and Bayesian Learning</a><ul id="R-subsections-6e37e5026001eb89123afab26613c1bf" class="collapsible-menu"></ul></li>
            <li class="" data-nav-id="/probintro/glossary/index.html"><a class="padding" href="/probintro/glossary/index.html">Glossary - All Tutorials</a></li>
          </ul>
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-shortcuts">
          <ul class="space collapsible-menu">
          </ul>
        </div>
        <div id="R-footer-margin"></div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-footercontrols">
          <ul class="">
          </ul>
        </div>
<div id="R-footer"><p>Built with <a href="https://github.com/McShelby/hugo-theme-relearn" title="love"><i class="fas fa-heart"></i></a> by <a href="https://gohugo.io/">Hugo</a></p></div>
      </div>
    </aside>
    <script>
      window.MathJax = Object.assign( window.MathJax || {}, {
        tex: {
          inlineMath:  [['\\(', '\\)'], ['$',  '$']],  
          displayMath: [['\\[', '\\]'], ['$$', '$$']], 
        },
        options: {
          enableMenu: false 
        }
      }, JSON.parse("{}") );
    </script>
    <script id="MathJax-script" async src="/probintro/js/mathjax/tex-mml-chtml.js?1764237447"></script>
    <script src="/probintro/js/clipboard/clipboard.min.js?1764237447" defer></script>
    <script src="/probintro/js/perfect-scrollbar/perfect-scrollbar.min.js?1764237447" defer></script>
    <script src="/probintro/js/theme.js?1764237447" defer></script>
  </body>
</html>
